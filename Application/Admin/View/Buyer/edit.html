<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta charset="utf-8" />
  <title>媒体管理</title>

  <meta name="description" content="Static &amp; Dynamic Tables" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

  <!-- bootstrap & fontawesome -->
  <link rel="stylesheet" href="__PUBLIC__/assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="__PUBLIC__/assets/css/font-awesome.min.css" />

  <!-- page specific plugin styles -->

  <!-- text fonts -->
  <link rel="stylesheet" href="__PUBLIC__/assets/css/ace-fonts.css" />

  <!-- ace styles -->
  <link rel="stylesheet" href="__PUBLIC__/assets/css/ace.min.css" id="main-ace-style" />

  <!--[if lte IE 9]>
  <link rel="stylesheet" href="__PUBLIC__/assets/css/ace-part2.min.css" />
  <![endif]-->
  <link rel="stylesheet" href="__PUBLIC__/assets/css/ace-skins.min.css" />
  <link rel="stylesheet" href="__PUBLIC__/assets/css/ace-rtl.min.css" />

  <!--[if lte IE 9]>
  <link rel="stylesheet" href="__PUBLIC__/assets/css/ace-ie.min.css" />
  <![endif]-->

  <!-- inline styles related to this page -->

  <!-- ace settings handler -->
  <script src="__PUBLIC__/assets/js/ace-extra.min.js"></script>
  <script type="text/javascript">
    window.jQuery || document.write("<script src='__PUBLIC__/assets/js/jquery.min.js'>"+"<"+"/script>");
  </script>
  <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

  <!--[if lte IE 8]>
  <script src="__PUBLIC__/assets/js/html5shiv.min.js"></script>
  <script src="__PUBLIC__/assets/js/respond.min.js"></script>
  <![endif]-->
</head>

<body class="no-skin">
<!-- #section:basics/navbar.layout -->
<div id="navbar" class="navbar navbar-default">
  <script type="text/javascript">
    try{ace.settings.check('navbar' , 'fixed')}catch(e){}
  </script>

  <!-- /.navbar-container -->
  <!-- 头部 -->
  <include file="Common/head"/>
</div>

<!-- /section:basics/navbar.layout -->
<div class="main-container" id="main-container">
  <script type="text/javascript">
    try{ace.settings.check('main-container' , 'fixed')}catch(e){}
  </script>

  <!-- #section:basics/sidebar -->
  <!-- 导航条 -->
  <include file="Common/navigation"/>
  <!-- /section:basics/sidebar -->

  <!-- 正文 -->
  <div class="main-content">
    <!-- #section:basics/content.breadcrumbs -->
    <div class="breadcrumbs" id="breadcrumbs">
      <script type="text/javascript">
        try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
      </script>

      <ul class="breadcrumb">
        <li>
          <i class="ace-icon fa fa-home home-icon"></i>
          <a href="#">账户管理</a>
        </li>

        <li>
          <a href="#">买方账户</a>
        </li>

        <li class="active">修改买方账户</li>
      </ul><!-- /.breadcrumb -->

      <!-- #section:basics/content.searchbox -->
      <div class="nav-search" id="nav-search">

      </div><!-- /.nav-search -->

      <!-- /section:basics/content.searchbox -->
    </div>

    <!-- /section:basics/content.breadcrumbs -->
    <div class="page-content">
      <!-- #section:settings.box -->

      <!-- /section:settings.box -->
      <div class="page-content-area">
        <include file="Common/settings.box"/>
        <div class="row">
          <div class="col-xs-12">
            <!-- PAGE CONTENT BEGINS -->
            <form class="form-horizontal" id="Form">
              <!-- #section:elements.form -->
              <input type="hidden" value="{$buyer.id}" name="id">

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 账户名称 </label>

                <div class="col-sm-9">
                  <input type="text" id="Email" name="email" placeholder="邮箱" value="{$buyer.email}" class="col-xs-10 col-sm-5" />
                  <span class="help-inline col-xs-12 col-sm-7">
												<span class="middle" id="EmailMessage" style="color:red;"></span>
											</span>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 联系人 </label>

                <div class="col-sm-9">
                  <input type="text" name="linkman" placeholder="联系人" id='Linkman' value="{$buyer.linkman}" class="col-xs-10 col-sm-5" />
                  <span class="help-inline col-xs-12 col-sm-7">
												<span class="middle" style="color: red;" id="LinkmanMsg"></span>
											</span>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 手机号码 </label>

                <div class="col-sm-9">
                  <input type="text" name="mobileTel" placeholder="手机号码" id="MobileTel" value="{$buyer.mobiletel}" class="col-xs-10 col-sm-5" />
                  <span class="help-inline col-xs-12 col-sm-7">
												<span class="middle" style="color: red;" id="MobileTelMsg"></span>
											</span>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 公司名称 </label>

                <div class="col-sm-9">
                  <input type="text" name="company" placeholder="公司名称" id="Company" value="{$buyer.company}" class="col-xs-10 col-sm-5" />
                  <span class="help-inline col-xs-12 col-sm-7">
												<span class="middle" style="color: red;" id="CompanyMsg"></span>
											</span>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 公司地址 </label>

                <div class="col-sm-9">
                  <input type="text" name="address" placeholder="公司地址" id="Address" value="{$buyer.address}" class="col-xs-10 col-sm-5" />
                  <span class="help-inline col-xs-12 col-sm-7">
												<span class="middle" style="color: red;" id="AddressMsg"></span>
											</span>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 邮编 </label>

                <div class="col-sm-9">
                  <input type="text" name="zip" placeholder="邮编" id="Zip" value="{$buyer.zip}" class="col-xs-10 col-sm-5" />
                  <span class="help-inline col-xs-12 col-sm-7">
												<span class="middle" style="color: red;" id="ZipMsg"></span>
											</span>
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 购买类型 </label>

                <div class="col-sm-9">
                  <input type="radio" name="buyType" <?php echo $buyer['buytype']==1 ? 'checked=""' : ''; ?> value="1"> rtb
                  <input type="radio" name="buyType" <?php echo $buyer['buytype']==2 ? 'checked=""' : ''; ?> value="2"> adn
                </div>
              </div>

              <div class="form-group">
                <label class="col-sm-3 control-label no-padding-right" > 素材审核类型 </label>

                <div class="col-sm-9">
                  <input type="radio" name="creativeAuditType" <?php echo $buyer['creativeaudittype']==1 ? 'checked=""' : ''; ?> value="1"> 先审后投
                  <input type="radio" name="creativeAuditType" <?php echo $buyer['creativeaudittype']==2 ? 'checked=""' : ''; ?> value="2"> 先投后审
                </div>
              </div>

              <div class="form-group" style="{$gainTypeHidden}" >
                <label class="col-sm-3 control-label no-padding-right" > 盈利模式 </label>

                <div class="col-sm-9">
                  <input type="radio" name="gainType" <?php echo $buyer['gaintype']==1 ? 'checked=""' : ''; ?> value="1"> 成交价上浮
                  <input type="radio" name="gainType" <?php echo $buyer['gaintype']==2 ? 'checked=""' : ''; ?> value="2"> 扣量
                </div>
              </div>

              <div class="form-group" style="{$gainTypeHidden}" >
                <label class="col-sm-3 control-label no-padding-right" > 盈利比例 </label>

                <div class="col-sm-9">
                  <input type="text" value="{$buyer.gainrate}" name="gainRate" placeholder="盈利比例" id="GainRate" class="col-xs-10 col-sm-5" />
                  <span class="help-inline col-xs-11 col-sm-6" style="padding: 0;">
                  <span style="font-size: 16px;display:block;margin-top:4px">%</span>

												<span class="middle" style="color: red;" id="GainRateMsg"></span>
											</span>
                </div>
              </div>

              <div class="clearfix form-actions">
                <div class="col-md-offset-3 col-md-9">
                  <button class="btn btn-info" id="Submit" type="button">
                    <i class="ace-icon fa fa-check bigger-110"></i>
                    确定
                  </button>

                  &nbsp; &nbsp; &nbsp;
                  <button class="btn" type="reset" id="return">
                    <i class="ace-icon fa fa-undo bigger-110"></i>
                    返回
                  </button>
                </div>
              </div>
            </form>

          </div><!-- /.col -->
        </div>

      </div><!-- /.page-content-area -->
    </div><!-- /.page-content -->
  </div><!-- /.main-content -->
  <!-- 正文结束 -->

  <!-- 尾部 -->
  <include file="Common/footer"/>

  <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
    <i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
  </a>
</div><!-- /.main-container -->

<!-- basic scripts -->

<!--[if !IE]> -->
<script type="text/javascript">
  window.jQuery || document.write("<script src='__PUBLIC__/assets/js/jquery.min.js'>"+"<"+"/script>");
</script>

<!-- <![endif]-->

<!--[if IE]>
<script type="text/javascript">
  window.jQuery || document.write("<script src='__PUBLIC__/assets/js/jquery1x.min.js'>"+"<"+"/script>");
</script>
<![endif]-->
<script type="text/javascript">
  if('ontouchstart' in document.documentElement) document.write("<script src='__PUBLIC__/assets/js/jquery.mobile.custom.min.js'>"+"<"+"/script>");
</script>
<script src="__PUBLIC__/assets/js/bootstrap.min.js"></script>

<!-- page specific plugin scripts -->
<script src="__PUBLIC__/assets/js/jquery.dataTables.min.js"></script>
<script src="__PUBLIC__/assets/js/jquery.dataTables.bootstrap.js"></script>

<!-- ace scripts -->
<script src="__PUBLIC__/assets/js/ace-elements.min.js"></script>
<script src="__PUBLIC__/assets/js/ace.min.js"></script>

<!-- inline scripts related to this page -->
<script type="text/javascript">
  jQuery(function($) {
    var oTable1 =
        $('#sample-table-2')
        //.wrap("<div class='dataTables_borderWrap' />")   //if you are applying horizontal scrolling (sScrollX)
            .dataTable({
              bAutoWidth: false,
              "aoColumns": [
                {"bSortable": false},
                null, null, null, null, null,
                {"bSortable": false}
              ],
              "aaSorting": [],
            });

    $(document).on('click', 'th input:checkbox', function () {
      var that = this;
      $(this).closest('table').find('tr > td:first-child input:checkbox')
          .each(function () {
            this.checked = that.checked;
            $(this).closest('tr').toggleClass('selected');
          });
    });


    $('[data-rel="tooltip"]').tooltip({placement: tooltip_placement});
    function tooltip_placement(context, source) {
      var $source = $(source);
      var $parent = $source.closest('table')
      var off1 = $parent.offset();
      var w1 = $parent.width();

      var off2 = $source.offset();
      //var w2 = $source.width();

      if (parseInt(off2.left) < parseInt(off1.left) + parseInt(w1 / 2)) return 'right';
      return 'left';
    }

    //    表单验证

    $('#Email').blur(function () {
      var val = $(this).val();
      if (val == "") {
        $('#EmailMessage').html('不能为空');
      } else if (!val.match(/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/)) {
        $('#EmailMessage').html('邮箱格式不正确');
      } else {
        $('#EmailMessage').html('');
      }
    });

    $('#Linkman').blur(function () {
      var val = $(this).val();
      if (val == '') {
        $('#LinkmanMsg').html('不能为空');
      } else {
        $('#LinkmanMsg').html('');
      }
    });

    $('#Company').blur(function () {
      var val = $(this).val();
      if (val == '') {
        $('#CompanyMsg').html('不能为空');
      } else {
        $('#CompanyMsg').html('');
      }
    });

    $('#Address').blur(function () {
      var val = $(this).val();
      if (val == '') {
        $('#AddressMsg').html('不能为空');
      } else {
        $('#AddressMsg').html('');
      }
    });

    $('#Zip').blur(function () {
      var val = $(this).val();
      if (val == '') {
        $('#ZipMsg').html('不能为空');
      } else {
        $('#ZipMsg').html('');
      }
    });

    $('#MobileTel').blur(function () {
      var val = $(this).val();
      if (val == '') {
        $('#MobileTelMsg').html('不能为空');
      } else if (!val.match(/^1\d{10}$/)) {
        $('#MobileTelMsg').html('手机格式不正确');
      } else {
        $('#MobileTelMsg').html('');
      }
    });

    $('#GainRate').blur(function () {
      var val = $(this).val();
      if(val == '') {
        $('#GainRateMsg').html('不能为空');
      }else if(isNaN(val) || val < 0 || val > 100) {
        $('#GainRateMsg').html('需填入0-100的数字');
      }else{
        $('#GainRateMsg').html('');
      }
    });

    $('#Submit').click(function () {
      if ($('#Email').val() == '' || $('#Company').val() == '' || $('#Zip').val() == '' || $('#Address').val() == '' ||    $('#MobileTel').val() == '' || $('#EmailMessage').val() != '' || $('#CompanyMsg').val() != '' || $('#ZipMsg').val() != '' || $('#AddressMsg').val() != '' || $('#MobileTelMsg').val() != '') {
        alert('请填写完整信息');
        return false;
      }
      var formData = new FormData($( "#Form" )[0]);
      $.ajax({
        url: '/buyer/edit',
        type: 'POST',
        data: formData,
        async: false,
        cache: false,
        contentType: false,
        processData: false,
        success: function (result) {
          if(result.status == 'ok'){
            location.href = '/buyer/index';
          }else {
            alert(result.msg);
          }
        },
        error: function (returndata) {
          alert(returndata);
        }
      });
    });
  });

  $('#return').click(function () {
    location.href = '/buyer/index';
  });
</script>

</body>
</html>
